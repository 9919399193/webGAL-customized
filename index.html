<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <link rel="icon" type="image/svg+xml" href="/src/favicon.svg"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>WebGAL NG</title>
    <style>
        a {
            transition: color 1s;
        }

        a:link {
            color: #434343;
        }

        a:visited {
            color: #434343;
        }

        a:hover {
            color: #434343;
        }

        a:active {
            color: #434343;
        }
    </style>
</head>
<body>
<div id="Title_enter_page" onclick="enter()" style="
            width: 1600px;
            height: 900px;
            overflow: hidden;
            background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
            position: absolute;
            top: 0;
            z-index: 14;
            opacity: 1;
            transition: opacity 2s, background 2s;
">
    <div id="Title_enter_text" style="width: 100%;
    height: 100%;
    opacity: 1;
    transition: opacity 1s;
    font-family: Georgia,serif">
        <div class="toCenter" style="
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
">
            <div class="StartButton" style="font-size: xx-large;letter-spacing: 0.25em ;padding: 2em 2em 2em 2em">
                PRESS THE SCREEN TO START
            </div>
        </div>
        <div
            style="position: absolute;
        bottom: 1em;
        display: flex;
        justify-content: center;
        width: 100%;
        flex-flow: column;
        align-items: center ">
            <div style="padding: 0 0 0.25em 0">
                Powered by <a href="https://github.com/MakinoharaShoko/WebGAL">WebGAL</a> Framework
            </div>
            <div>
                Made with ❤ by <a href="https://github.com/MakinoharaShoko">Mahiru</a>
            </div>
        </div>
    </div>
</div>
<div id="root"></div>
<script type="module" src="/src/main.tsx"></script>
<script>
    // 激活强制缩放
    // 在调整窗口大小时重新计算宽高，设计稿按照 1600*900。
    setTimeout(resizeTitle, 100);
    resizeTitle();
    window.onresize = resizeTitle;
    // 监听键盘 F11 事件，全屏时触发页面调整
    document.onkeydown = function (event) {
        const e = event;
        if (e && e.keyCode === 122) {
            setTimeout(() => {
                resizeTitle();
            }, 100);
        }
    };

    function enter() {
        document.getElementById('Title_enter_text').style.opacity = '0';
        const title = document.getElementById('Title_enter_page');
        title.style.opacity = '0';
        title.style.pointerEvents = 'none';
        title.style.background = 'linear-gradient( #a1c4fd 0%,#FFFFFF 40%,#FFFFFF 60%, #c2e9fb 100%)';
        setTimeout(() => title.style.display = 'none', 2000) // 将落地页设置为不显示
        /**
         * 将播放bgm的事件发送出去
         */
        const event = new MouseEvent('click', {
            'view': window,
            'bubbles': true,
            'cancelable': true,
        });
        const target = document.getElementById('play_title_bgm_target');
        if (target !== null) {
            target.dispatchEvent(event);
        }
    }

    function resizeTitle() {
        const targetHeight = 900;
        const targetWidth = 1600;

        const h = window.innerHeight; // 窗口高度
        const w = window.innerWidth; // 窗口宽度
        const zoomH = h / targetHeight; // 以窗口高度为基准的变换比
        const zoomW = w / targetWidth; // 以窗口宽度为基准的变换比
        const zoomH2 = w / targetHeight; // 竖屏时以窗口高度为基础的变换比
        const zoomW2 = h / targetWidth; // 竖屏时以窗口宽度为基础的变换比
        let mh = (targetHeight - h) / 2; // y轴移动距离
        let mw = (targetWidth - w) / 2; // x轴移动距离
        let mh2os = targetWidth / 2 - w / 2; // 竖屏时 y轴移动距离
        let mw2os = targetHeight / 2 - h / 2; // 竖屏时 x轴移动距离
        const root = document.getElementById('Title_enter_page'); // 获取根元素
        if (root) {
            if (w > h) {
                mw = -mw;
                mh = -mh;
                if (w * (9 / 16) >= h) {
                    root.style.transform = `translate(${mw}px, ${mh}px) scale(${zoomH},${zoomH})`;
                }
                if (w * (9 / 16) < h) {
                    root.style.transform = `translate(${mw}px, ${mh}px) scale(${zoomW},${zoomW})`;
                }
            } else {
                mw2os = -mw2os;
                if (h * (9 / 16) >= w) {
                    root.style.transform = `rotate(90deg) translate(${mw2os}px, ${mh2os}px) scale(${zoomH2},${zoomH2})`;
                }
                if (h * (9 / 16) < w) {
                    root.style.transform = `rotate(90deg) translate(${mw2os}px, ${mh2os}px) scale(${zoomW2},${zoomW2})`;
                }
            }
        }
    }
</script>
</body>
</html>
